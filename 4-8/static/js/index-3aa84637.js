var e=Object.defineProperty,l=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,t=(l,a,o)=>a in l?e(l,a,{enumerable:!0,configurable:!0,writable:!0,value:o}):l[a]=o,i=(e,i)=>{for(var r in i||(i={}))a.call(i,r)&&t(e,r,i[r]);if(l)for(var r of l(i))o.call(i,r)&&t(e,r,i[r]);return e};import{D as r,E as u,e as n,F as d,_ as s,l as p,G as m,H as c}from"./index-d3c82361.js";import{f,a0 as v,$ as b,o as g,M as y,O as _,V as h,c as V,a4 as w,F as I,u as C,E as j,T as x,a as D,U as k,j as F,a8 as N,P as O}from"./@vue-476d9f53.js";import{u as U}from"./vue-router-3b718848.js";import{V as z}from"./@element-plus-b1a64a18.js";import"./dayjs-43ef48e6.js";import"./@kangc-16b25a8c.js";import"./vue-3198b1a1.js";import"./axios-f45f83e3.js";import"./element-plus-520742f9.js";import"./lodash-es-b6050654.js";import"./@vueuse-53812618.js";import"./@ctrl-eb0b847c.js";import"./async-validator-1193b133.js";import"./memoize-one-99e54574.js";import"./escape-html-4bbaf1e1.js";import"./normalize-wheel-es-eea50788.js";import"./@floating-ui-a9dc73ab.js";import"./echarts-ed669956.js";import"./zrender-93d325f0.js";import"./vuex-9b0668b4.js";import"./js-base64-8ead6284.js";import"./vuex-persistedstate-1d34ce44.js";import"./screenfull-c3c7916b.js";import"./nprogress-fdca1b68.js";const L=x("保存"),M=x("关闭"),S={props:{giftDialogVisible:{type:Boolean},userInfo:{type:Object},giftForm:{type:Object}},emits:["closeGiftDialog"],setup(e,{expose:l,emit:a}){const o=e,t=f(),n=v({giftId:[{required:!0,message:"请选择礼品卡",trigger:"blur"}],num:[{required:!0,message:"赠送数量不能为空",trigger:"blur"}]}),d=f([]),s=async()=>{t.value.validate((async e=>{if(!e)return!1;0==(await u(i({userId:o.userInfo.id,type:1},o.giftForm))).code&&p()}))},p=()=>{a("closeGiftDialog")};return l({getGiftList:async()=>{const e=await r({pageNo:1,pageSize:1e6});d.value=e.data.list}}),(l,a)=>{const o=b("el-option"),i=b("el-select"),r=b("el-form-item"),u=b("el-input-number"),m=b("el-button"),c=b("el-form"),f=b("el-dialog");return g(),y(f,{modelValue:e.giftDialogVisible,"onUpdate:modelValue":a[2]||(a[2]=e=>j(giftDialogVisible)?giftDialogVisible.value=e:null),title:"送礼品券",width:"500px",onClose:p},{default:_((()=>[h(c,{ref_key:"giftFormRef",ref:t,rules:C(n),model:e.giftForm,class:"demo-form-inline","label-width":"100px","label-position":l.right},{default:_((()=>[h(r,{label:"礼品卡",prop:"giftId"},{default:_((()=>[h(i,{modelValue:e.giftForm.giftId,"onUpdate:modelValue":a[0]||(a[0]=l=>e.giftForm.giftId=l),placeholder:"请选择礼品卡",clearable:"",filterable:"",style:{width:"200px"}},{default:_((()=>[(g(!0),V(I,null,w(d.value,(e=>(g(),y(o,{label:e.name,value:e.id},null,8,["label","value"])))),256))])),_:1},8,["modelValue"])])),_:1}),h(r,{label:"赠送数量",prop:"num"},{default:_((()=>[h(u,{modelValue:e.giftForm.num,"onUpdate:modelValue":a[1]||(a[1]=l=>e.giftForm.num=l),placeholder:"赠送数量","controls-position":"right",clearable:"",style:{width:"200px"},min:"1"},null,8,["modelValue"])])),_:1}),h(r,{class:"footer"},{default:_((()=>[h(m,{type:"primary",onClick:s},{default:_((()=>[L])),_:1}),h(m,{onClick:p},{default:_((()=>[M])),_:1})])),_:1})])),_:1},8,["rules","model","label-position"])])),_:1},8,["modelValue"])}}},R=x("保存"),q=x("关闭"),G={props:{couponDialogVisible:{type:Boolean},userInfo:{type:Object},couponForm:{type:Object}},emits:["closeCouponDialog"],setup(e,{expose:l,emit:a}){const o=e,t=f(),r=v({couponId:[{required:!0,message:"请选择优惠券",trigger:"blur"}],num:[{required:!0,message:"赠送数量不能为空",trigger:"blur"}]}),u=f([]),s=async()=>{t.value.validate((async e=>{if(!e)return!1;0==(await d(i({userId:o.userInfo.id,type:1},o.couponForm))).code&&p()}))},p=()=>{a("closeCouponDialog")};return l({getCouponList:async()=>{const e=await n({pageNo:1,pageSize:1e6,status:1});u.value=e.data.list}}),(l,a)=>{const o=b("el-option"),i=b("el-select"),n=b("el-form-item"),d=b("el-input-number"),m=b("el-button"),c=b("el-form"),f=b("el-dialog");return g(),y(f,{modelValue:e.couponDialogVisible,"onUpdate:modelValue":a[2]||(a[2]=e=>j(couponDialogVisible)?couponDialogVisible.value=e:null),title:"送优惠券",width:"500px",onClose:p},{default:_((()=>[h(c,{ref_key:"couponFormRef",ref:t,rules:C(r),model:e.couponForm,class:"demo-form-inline","label-width":"100px","label-position":l.right},{default:_((()=>[h(n,{label:"优惠券",prop:"couponId"},{default:_((()=>[h(i,{modelValue:e.couponForm.couponId,"onUpdate:modelValue":a[0]||(a[0]=l=>e.couponForm.couponId=l),placeholder:"请选择优惠券",clearable:"",filterable:"",style:{width:"200px"}},{default:_((()=>[(g(!0),V(I,null,w(u.value,(e=>(g(),y(o,{label:e.name,value:e.id},null,8,["label","value"])))),256))])),_:1},8,["modelValue"])])),_:1}),h(n,{label:"赠送数量",prop:"num"},{default:_((()=>[h(d,{modelValue:e.couponForm.num,"onUpdate:modelValue":a[1]||(a[1]=l=>e.couponForm.num=l),placeholder:"赠送数量","controls-position":"right",clearable:"",style:{width:"200px"},min:"1"},null,8,["modelValue"])])),_:1}),h(n,{class:"footer"},{default:_((()=>[h(m,{type:"primary",onClick:s},{default:_((()=>[R])),_:1}),h(m,{onClick:p},{default:_((()=>[q])),_:1})])),_:1})])),_:1},8,["rules","model","label-position"])])),_:1},8,["modelValue"])}}};const T=x("用户信息"),B={class:"userInfo"},E={class:"infos"},P={class:"infos"},H={class:"infos",style:{display:"flex","align-items":"center"}},$=x("送优惠券"),A=x("送礼品券"),J=x("其他信息"),K=x("购物明细"),Q=x("礼品卡明细"),W=x("合成卡明细"),X=x("优惠券明细");var Y=s({props:{editOrCreateDialogVisible:{type:Boolean},userInfo:{type:Object},active:{type:String}},emits:["closeDialog"],setup(e,{emit:l}){const a=U(),o=()=>{l("closeDialog")},t=f(!1),i=f(),r=f({giftId:"",num:""}),u=()=>{t.value=!0,i.value.getGiftList()},n=()=>{r.value.num="",r.value.giftId="",t.value=!1},d=f(!1),s=f(),p=()=>{d.value=!0,s.value.getCouponList()},m=f({couponId:"",num:""}),c=()=>{m.value.num="",m.value.giftId="",d.value=!1};return(l,f)=>{const v=b("el-divider"),y=b("el-image"),w=b("el-button"),C=b("el-dialog");return g(),V(I,null,[h(C,{modelValue:e.editOrCreateDialogVisible,"onUpdate:modelValue":f[4]||(f[4]=e=>j(editOrCreateDialogVisible)?editOrCreateDialogVisible.value=e:null),title:"编辑",width:"800px",onClose:o},{default:_((()=>[h(v,{class:"divider","content-position":"left"},{default:_((()=>[T])),_:1}),D("div",B,[h(y,{src:e.userInfo.avatar,style:{width:"80px","border-radius":"10px"}},null,8,["src"]),D("div",E,[D("div",null,"用户昵称："+k(e.userInfo.name),1),D("div",null,"用户手机："+k(e.userInfo.mobile),1),D("div",null,"注册时间："+k(e.userInfo.regTime),1),D("div",null,"会员等级："+k(e.userInfo.levelName),1)]),D("div",P,[D("div",null,"团长姓名："+k(e.userInfo.leaderName||"null"),1),D("div",null,"团长手机："+k(e.userInfo.leaderMobile||"null"),1)]),D("div",H,[h(w,{type:"primary",onClick:p},{default:_((()=>[$])),_:1}),h(w,{style:{"margin-left":"10px"},type:"primary",onClick:u},{default:_((()=>[A])),_:1})])]),h(v,{class:"divider","content-position":"left"},{default:_((()=>[J])),_:1}),h(w,{type:"primary",onClick:f[0]||(f[0]=l=>{return o=e.userInfo.id,void a.push({path:"/orderList",query:{userId:o}});var o})},{default:_((()=>[K])),_:1}),h(w,{type:"primary",onClick:f[1]||(f[1]=l=>{return o=e.userInfo.id,void a.push({path:"/userGiftCardList",query:{userId:o}});var o})},{default:_((()=>[Q])),_:1}),h(w,{type:"primary",onClick:f[2]||(f[2]=l=>{return o=e.userInfo.id,void a.push({path:"/userCompositeCardList",query:{userId:o}});var o})},{default:_((()=>[W])),_:1}),h(w,{type:"primary",onClick:f[3]||(f[3]=l=>{return o=e.userInfo.id,void a.push({path:"/userCouponList",query:{userId:o}});var o})},{default:_((()=>[X])),_:1})])),_:1},8,["modelValue"]),h(S,{ref_key:"giftFormRef",ref:i,userInfo:e.userInfo,giftDialogVisible:t.value,giftForm:r.value,onCloseGiftDialog:n},null,8,["userInfo","giftDialogVisible","giftForm"]),h(G,{ref_key:"couponFormRef",ref:s,userInfo:e.userInfo,couponDialogVisible:d.value,couponForm:m.value,onCloseCouponDialog:c},null,8,["userInfo","couponDialogVisible","couponForm"])],64)}}},[["__scopeId","data-v-9ac5abd4"]]);const Z=x("查询"),ee=x("重置"),le=x("导出"),ae={key:0,class:"leader"},oe={key:1},te=["onClick","icon"],ie={class:"pagination"};var re=s({setup(e){const l=f(),a={name:"",mobile:"",type:"",leaderName:"",leaderMobile:""},o=f(!1),t=f(i({},a)),r=f({pageNo:1,pageSize:20,total:0}),u=f({id:0,name:"",avatar:"",mobile:"",leaderName:"",leaderMobile:"",levelName:"",regTime:""}),n=f(!1);let d=f([]);const s=f("1"),v=f(null),w=async()=>{o.value=!0;const e=await m(i(i({},t.value),r.value));d.value=e.data.list,r.value.total=e.data.total,o.value=!1},j=e=>{r.value.pageSize=e,w()},x=e=>{r.value.pageNo=e,w()},U=()=>{n.value=!1},L=async()=>{o.value=!0;const e=await c({name:t.value.name,mobile:t.value.mobile,type:t.value.type,leaderName:t.value.leaderName,leaderMobile:t.value.leaderMobile});o.value=!1;var l=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=utf-8"});const a="用户信息表",i=document.createElement("a");"download"in i?(i.download=a,i.style.display="none",i.href=URL.createObjectURL(l),document.body.appendChild(i),i.click(),URL.revokeObjectURL(i.href),document.body.removeChild(i)):navigator.msSaveBlob(l,a)};return F((()=>{(async()=>{const e=await p({pageNo:1,pageSize:1e4});l.value=e.data.list})(),w()})),(e,l)=>{const p=b("el-input"),m=b("el-form-item"),c=b("el-col"),f=b("el-option"),F=b("el-select"),M=b("el-button"),S=b("el-row"),R=b("el-form"),q=b("el-card"),G=b("el-table-column"),T=b("el-image"),B=b("el-table"),E=b("el-pagination"),P=N("loading");return g(),V(I,null,[h(q,null,{default:_((()=>[h(R,{inline:!0,model:t.value,class:"demo-form-inline","lable-width":"100px"},{default:_((()=>[h(S,null,{default:_((()=>[h(c,{lg:6,md:12,sm:12},{default:_((()=>[h(m,{label:"用户昵称"},{default:_((()=>[h(p,{modelValue:t.value.name,"onUpdate:modelValue":l[0]||(l[0]=e=>t.value.name=e),placeholder:"用户昵称",clearable:""},null,8,["modelValue"])])),_:1})])),_:1}),h(c,{lg:6,md:12,sm:12},{default:_((()=>[h(m,{label:"用户手机"},{default:_((()=>[h(p,{modelValue:t.value.mobile,"onUpdate:modelValue":l[1]||(l[1]=e=>t.value.mobile=e),placeholder:"用户手机",clearable:""},null,8,["modelValue"])])),_:1})])),_:1}),h(c,{lg:6,md:12,sm:12},{default:_((()=>[h(m,{label:"团长名称"},{default:_((()=>[h(p,{modelValue:t.value.leaderName,"onUpdate:modelValue":l[2]||(l[2]=e=>t.value.leaderName=e),placeholder:"团长名称",clearable:""},null,8,["modelValue"])])),_:1})])),_:1}),h(c,{lg:6,md:12,sm:12},{default:_((()=>[h(m,{label:"团长手机"},{default:_((()=>[h(p,{modelValue:t.value.leaderMobile,"onUpdate:modelValue":l[3]||(l[3]=e=>t.value.leaderMobile=e),placeholder:"团长手机",clearable:""},null,8,["modelValue"])])),_:1})])),_:1}),h(c,{lg:6,md:12,sm:12},{default:_((()=>[h(m,{label:"用户类型"},{default:_((()=>[h(F,{modelValue:t.value.type,"onUpdate:modelValue":l[4]||(l[4]=e=>t.value.type=e),placeholder:"请选择用户类型",style:{width:"90%"},clearable:""},{default:_((()=>[h(f,{label:"普通用户",value:"0"}),h(f,{label:"团长",value:"1"})])),_:1},8,["modelValue"])])),_:1})])),_:1}),h(m,null,{default:_((()=>[h(M,{type:"primary",onClick:w},{default:_((()=>[Z])),_:1}),h(M,{onClick:l[5]||(l[5]=e=>(t.value=i({},a),void w()))},{default:_((()=>[ee])),_:1})])),_:1})])),_:1})])),_:1},8,["model"])])),_:1}),h(q,{style:{"margin-top":"10px"}},{default:_((()=>[h(M,{icon:C(z),style:{"margin-bottom":"20px"},onClick:L},{default:_((()=>[le])),_:1},8,["icon"]),O((g(),y(B,{data:C(d),style:{width:"100%"},"header-cell-style":{background:"#f7f8fa",color:"#000"}},{default:_((()=>[h(G,{prop:"name",label:"用户昵称",width:"150",align:"center"}),h(G,{prop:"avatar",label:"头像",width:"120",align:"center"},{default:_((e=>[h(T,{style:{width:"60px",height:"60px","border-radius":"5px"},src:e.row.avatar,lazy:""},null,8,["src"])])),_:1}),h(G,{prop:"mobile",label:"用户手机"}),h(G,{label:"团长"},{default:_((e=>[e.row.leaderName&&e.row.leaderMobile?(g(),V("div",ae,[D("div",null," 团长："+k(e.row.leaderName),1),D("div",null," 手机："+k(e.row.leaderMobile),1),D("div",null," 门店："+k(e.row.leaderStore),1),D("div",null," 地址："+k(e.row.address),1)])):(g(),V("div",oe,"无"))])),_:1}),h(G,{label:"用户类型",align:"center"},{default:_((e=>[D("div",null,k(0==e.row.type?"普通用户":"团长"),1)])),_:1}),h(G,{prop:"levelName",label:"用户等级",align:"center"}),h(G,{prop:"regTime",label:"注册时间",width:"200",align:"center"}),h(G,{fixed:"right",label:"操作",width:"180",align:"center"},{default:_((l=>[D("span",{class:"operation",onClick:e=>(e=>{n.value=!0,u.value.id=e.row.id,u.value.name=e.row.name,u.value.avatar=e.row.avatar,u.value.mobile=e.row.mobile,u.value.leaderName=e.row.leaderName,u.value.leaderMobile=e.row.leaderMobile,u.value.levelName=e.row.levelName,u.value.regTime=e.row.regTime})(l),icon:e.Edit},"编辑",8,te)])),_:1})])),_:1},8,["data"])),[[P,o.value]]),D("div",ie,[h(E,{background:"",layout:"total, sizes, prev, pager, next, jumper","page-size":r.value.pageSize,"onUpdate:page-size":l[6]||(l[6]=e=>r.value.pageSize=e),"current-page":r.value.pageNo,"onUpdate:current-page":l[7]||(l[7]=e=>r.value.pageNo=e),"page-sizes":[10,20,50,100,200,500],total:r.value.total,onSizeChange:j,onCurrentChange:x},null,8,["page-size","current-page","total"])])])),_:1}),h(Y,{ref_key:"editUserInfoRef",ref:v,editOrCreateDialogVisible:n.value,userInfo:u.value,active:s.value,onCloseDialog:U},null,8,["editOrCreateDialogVisible","userInfo","active"])],64)}}},[["__scopeId","data-v-2443de02"]]);export{re as default};
