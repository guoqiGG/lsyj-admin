var e=Object.defineProperty,a=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,t=Object.prototype.propertyIsEnumerable,o=(a,l,t)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[l]=t,r=(e,r)=>{for(var s in r||(r={}))l.call(r,s)&&o(e,s,r[s]);if(a)for(var s of a(r))t.call(r,s)&&o(e,s,r[s]);return e};import{_ as s,p as i,k as u,m as n}from"./index-d3c82361.js";import{T as p}from"./@element-plus-b1a64a18.js";import{E as d}from"./element-plus-520742f9.js";import{f as c,a0 as m,j as f,$ as g,a8 as v,o as b,c as j,V as h,O as y,F as _,u as w,P as x,M as C,a as k,T as z,b6 as V,b5 as O}from"./@vue-476d9f53.js";import"./vue-router-3b718848.js";import"./dayjs-43ef48e6.js";import"./@kangc-16b25a8c.js";import"./vue-3198b1a1.js";import"./axios-f45f83e3.js";import"./echarts-ed669956.js";import"./zrender-93d325f0.js";import"./vuex-9b0668b4.js";import"./js-base64-8ead6284.js";import"./vuex-persistedstate-1d34ce44.js";import"./screenfull-c3c7916b.js";import"./nprogress-fdca1b68.js";import"./lodash-es-b6050654.js";import"./@vueuse-53812618.js";import"./@ctrl-eb0b847c.js";import"./async-validator-1193b133.js";import"./memoize-one-99e54574.js";import"./escape-html-4bbaf1e1.js";import"./normalize-wheel-es-eea50788.js";import"./@floating-ui-a9dc73ab.js";const S=e=>(V("data-v-775e510b"),e=e(),O(),e),U=z("查询"),E=z("重置"),I=z("新增"),P=["onClick","icon"],q=S((()=>k("span",{class:"operation"},"删除",-1))),N={class:"pagination"},F=z("保存"),T=z("关闭");var $=s({setup(e){const a=localStorage.getItem("token"),l={name:""},t=c(!0),o=c(!1),s=c(r({},l)),z=c({pageNo:1,pageSize:20}),V=c(0);let O=c([]);const S=c({id:0,name:"",url:"",sort:50}),$=c(),A=m({name:[{required:!0,message:"分类名称不能为空",trigger:"blur"}],url:[{required:!0,message:"请选择上传图片",trigger:"blur"}],sort:[{required:!0,message:"请输入排序",trigger:"blur"}]}),D=c(!1),L=async()=>{o.value=!0;const e=await i(r(r({},s.value),z.value));o.value=!1,O.value=e.data.list,V.value=e.data.total},M=e=>{z.value.pageSize=e,L()},B=e=>{z.value.pageNo=e,L()},R=(e,a,l)=>{S.value.url=e,d({showClose:!1,message:"上传成功",type:"success"})},G=(e,a,l)=>{d({showClose:!1,message:"上传失败",type:"danger"})},H=e=>{const a=e.name,l=a.substring(a.lastIndexOf(".")),t=".jpg"===l||".png"===l||".jpeg"===l||".bmp"===l||".gif"===l;t||this.$message.error("图片格式只能为jpeg/png/jpg/bmp/gif");const o=e.size/1024/1024<2;return o||this.$message.error("图片大小不能超过 2MB!"),o&&t},J=e=>{D.value=!0,e?(t.value=!1,S.value.id=e.row.id,S.value.name=e.row.name,S.value.url=e.row.url,S.value.sort=e.row.sort):t.value=!0},K=()=>{D.value=!1,W()},Q=async()=>{$.value.validate((async e=>{if(!e)return!1;if(t.value){0==(await n({name:S.value.name,url:S.value.url,sort:S.value.sort})).code&&(K(),L())}else{0==(await u({id:S.value.id,name:S.value.name,url:S.value.url,sort:S.value.sort})).code&&(K(),L())}}))},W=()=>{S.value={id:0,name:"",url:"",sort:50}};return f((()=>{L()})),(e,i)=>{const n=g("el-input"),d=g("el-form-item"),c=g("el-col"),m=g("el-button"),f=g("el-row"),X=g("el-form"),Y=g("el-card"),Z=g("el-table-column"),ee=g("el-image"),ae=g("el-popconfirm"),le=g("el-table"),te=g("el-pagination"),oe=g("Plus"),re=g("el-icon"),se=g("el-upload"),ie=g("el-input-number"),ue=g("el-dialog"),ne=v("loading");return b(),j(_,null,[h(Y,null,{default:y((()=>[h(X,{inline:!0,model:s.value,class:"demo-form-inline","lable-width":"100px"},{default:y((()=>[h(f,null,{default:y((()=>[h(c,{lg:6,md:12,sm:12},{default:y((()=>[h(d,{label:"分类名称"},{default:y((()=>[h(n,{modelValue:s.value.name,"onUpdate:modelValue":i[0]||(i[0]=e=>s.value.name=e),placeholder:"分类名称",clearable:""},null,8,["modelValue"])])),_:1})])),_:1}),h(d,null,{default:y((()=>[h(m,{type:"primary",onClick:L},{default:y((()=>[U])),_:1}),h(m,{onClick:i[1]||(i[1]=e=>(s.value=r({},l),void L()))},{default:y((()=>[E])),_:1})])),_:1})])),_:1})])),_:1},8,["model"])])),_:1}),h(Y,{style:{"margin-top":"10px"}},{default:y((()=>[h(m,{tag:"div",icon:w(p),type:"primary",onClick:i[2]||(i[2]=e=>J())},{default:y((()=>[I])),_:1},8,["icon"]),x((b(),C(le,{data:w(O),style:{width:"100%","margin-top":"10px"},"header-cell-style":{background:"#f7f8fa",color:"#000"}},{default:y((()=>[h(Z,{prop:"id",label:"ID",width:"100",align:"center"}),h(Z,{prop:"name",label:"名称",align:"center"}),h(Z,{label:"图片",align:"center",width:"350"},{default:y((e=>[h(ee,{style:{width:"300px",height:"100px","border-radius":"10px"},src:e.row.url,fit:"cover"},null,8,["src"])])),_:1}),h(Z,{prop:"sort",label:"排序",align:"center"}),h(Z,{prop:"createTime",label:"创建时间",width:"250",align:"center"}),h(Z,{fixed:"right",label:"操作",width:"180",align:"center"},{default:y((a=>[k("span",{class:"operation",onClick:e=>J(a),icon:e.Edit},"编辑",8,P),h(ae,{"confirm-button-text":"确定","cancel-button-text":"取消","cancel-button-type":"info","icon-color":"#626AEF",title:"确定要删除吗?",onConfirm:e=>(async(e,a)=>{0===(await u({id:e,isDeleted:a})).code&&L()})(a.row.id,1),onCancel:e.cancelEvent},{reference:y((()=>[q])),_:2},1032,["onConfirm","onCancel"])])),_:1})])),_:1},8,["data"])),[[ne,o.value]]),k("div",N,[h(te,{background:"",layout:"total, sizes, prev, pager, next, jumper","page-size":z.value.pageSize,"onUpdate:page-size":i[3]||(i[3]=e=>z.value.pageSize=e),"current-page":z.value.pageNo,"onUpdate:current-page":i[4]||(i[4]=e=>z.value.pageNo=e),"page-sizes":[10,20,50,100,200,500],total:V.value,onSizeChange:M,onCurrentChange:B},null,8,["page-size","current-page","total"])])])),_:1}),h(ue,{modelValue:D.value,"onUpdate:modelValue":i[8]||(i[8]=e=>D.value=e),title:t.value?"新增商品分类":"编辑商品分类",width:"600px",onClose:W},{default:y((()=>[h(X,{ref_key:"categoryFormRef",ref:$,rules:w(A),model:S.value,class:"demo-form-inline","lable-width":"100px"},{default:y((()=>[h(d,{label:"标题",prop:"name"},{default:y((()=>[h(n,{modelValue:S.value.name,"onUpdate:modelValue":i[5]||(i[5]=e=>S.value.name=e),placeholder:"标题",clearable:""},null,8,["modelValue"])])),_:1}),h(d,{label:"图片",prop:"url"},{default:y((()=>[h(se,{accept:"image/*","file-list":e.fileList,"onUpdate:file-list":i[6]||(i[6]=a=>e.fileList=a),class:"image-uploader","show-file-list":!1,action:w("https://qct.hnliyue.cn/youth")+"/upload/oss",headers:{Authorization:w(a)},"on-success":R,"on-error":G,"before-upload":H},{default:y((()=>[S.value.url?(b(),C(ee,{key:0,class:"avatar",controls:"controls",src:S.value.url},null,8,["src"])):(b(),C(re,{key:1,class:"image-uploader-icon"},{default:y((()=>[h(oe)])),_:1}))])),_:1},8,["file-list","action","headers"])])),_:1}),h(d,{label:"排序",prop:"sort"},{default:y((()=>[h(ie,{"controls-position":"right",modelValue:S.value.sort,"onUpdate:modelValue":i[7]||(i[7]=e=>S.value.sort=e),placeholder:"排序",clearable:""},null,8,["modelValue"])])),_:1}),h(d,{class:"footer"},{default:y((()=>[h(m,{type:"primary",onClick:Q},{default:y((()=>[F])),_:1}),h(m,{onClick:K},{default:y((()=>[T])),_:1})])),_:1})])),_:1},8,["rules","model"])])),_:1},8,["modelValue","title"])],64)}}},[["__scopeId","data-v-775e510b"]]);export{$ as default};
